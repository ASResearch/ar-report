% !TEX root = main.tex

\section{Manipulation-resistance of Core Nebulas Rank}

This chapter is the analysis on how Core Nebulas Rank resists manipulation, i.e. the fairness of Nebulas Rank.

\emph{Manipulation} is the fact that an attacker can take specific actions to obtain most benefit. The action space of attackers is to launch asset transfers, by making use of the assets and accounts controlled by them and their cooperators. Among the transfers, the amount of asset doesn't exceed the asset owned by the attacker; the source of transfer is either the accounts owned by the attacker and its cooperators, or some institutes' accounts who serve as exchanges. Usually, the benefit obtainable is determined by the accounts whose private keys are known by the attacker. A simple case is that the attacker's benefit is the sum of all of these accounts' ranking scores. Of course, it could be noticed that the private keys of institutes' accounts mentioned before are not controlled by the attacker.

The analysis of this section is based on the action space and attackers' benefit in simple case defined above. First, we discuss the upper-bound for a single account's ranking score enhancement. Then we analyze the upper-bound for multiple accounts. Last, collusion is included and we discuss the situation of more than one attacker.

\subsection{Ranking Score Enhancement for One Account \label{sec:cheat-single}}

In order to raise the ranking score for one account, according to formula \ref{eq:rank-param}, the ranking score of account is positively correlated with the amount of assets and in-and-out degree. The amount of assets in the account, i.e. $\beta$, has an upper bound, i.e. it is no more than the asset of the total assets owned by the attacker, denoted by $\beta_0$. And in-and-out degree $\gamma$ represents the volume of transfers, which means the attacker needs to increase the transfers amount of one controlled account as much as possible.

The increasing of transfer amount includes two parts: increasing in-degree and increasing out-degree. Increasing in-and-out degree needs two accounts as participants, one of which is the target account whose ranking score is aimed to raise, the other account could either be a controlled account or an  uncontrolled account. If it is an uncontrolled account, increasing degree means transacting with other people, this situation is discussed in \refsec{sec:coalition}. The other case is that the attacker sends assets to strangers unconditionally, which is too costly that it won't be discussed in this section. Therefore typically, it could be defined that, the actions of attackers mainly focus on increasing the transfers among the accounts controlled by themselves. Since the assets controlled by attackers are limited and the time period for ranking is also limited, it holds that the degree of an account has an upper-bound which is decided by the amount of assets held by the attacker.

As analyzed above, we consider the case of transferring with accounts of the same owner. Based on the computation method ~\ref{eq:rank-param} as defined in \refsec{sec:function}, the attacker's benefit will lower down if it split the asset transfers into multiple ones. Thus the attacker will try to make its transaction amount to be as high as possible, i.e. it tries to transfer all assets it owns into the account and then transfer it out all. Due to the cycle-removal algorithm, the attacker's asset cannot be transferred in again during this period. And the in-and-out degree is $\gamma = 2 \beta_0$. The ranking score is $\mathcal{C} =  \frac{2 \beta_0 ^2}{ (1+e^{a + b \cdot \beta_0}) (1+e^{c + 2 d \cdot \beta_0})}$.

Additionally, we consider a more advanced way to manipulate. Consider the case that the attacker manages to acquire the asset again somewhere else by transacting off-line. Then it could transfer the asset into the account again and the upper-bound of in-and-out degree is the asset amount times the number of off-line transactions. Since the ranking time period is limited, the upper-bound of the number of off-line transactions is a constant integer, i.e. $\gamma$ is bounded by $2T \cdot \beta_0$, where $T$ is a constant integer indicating the length of ranking time period. Therefore the upper-bound of score is $\mathcal{C} =  \frac{2T \cdot \beta_0 ^2}{ (1+e^{a + b \cdot \beta_0}) (1+e^{c + c \cdot d \cdot \beta_0})}$.

\subsection{Ranking Score Enhancement for Multiple Accounts (Sybil Attack)}
Sybil Attack refers to that the attacker obtains falsely high ranking score by creating large number of pseudo-identities to tamper the reputation system of P2P network ~\cite{quercia2010sybil}.

An entity on a peer-to-peer network is a piece of software which has access to local resources. An entity advertises itself on the peer-to-peer network by presenting an identity. More than one identity can correspond to a single entity. In other words, the mapping of identities to entities is many to one. Entities in peer-to-peer networks use multiple identities for purposes of redundancy, resource sharing, reliability and integrity. In peer-to-peer networks, the identity is used as an abstraction so that a remote entity can be aware of identities without necessarily knowing the correspondence of identities to local entities. By default, each distinct identity is usually assumed to correspond to a distinct local entity. In reality, many identities may correspond to the same local entity. An adversary may present multiple identities to a peer-to-peer network in order to appear and function as multiple distinct nodes. The adversary may thus be able to acquire a disproportionate level of control over the network, such as by affecting voting outcomes ~\cite{wiki:sybil}.

Here we assume the attacker's payoff is the sum of all accounts controlled by the attacker. Considering the strategy to enhance ranking score for one account, which is analyzed at last subsection, the attacker could apply the same strategy to multiple accounts: starting from any one account, the attacker transfer part of its asset into the next account, finally forming a linked asset flow. In this case, since Core Nebulas Rank requires that no more than valid amount of asset stays in the account for no more than half of the period, by no means the attacker could make $\beta$ for more than one account to be the total amount of assets owned by it. Thus the attacker should adopt another strategy where its assets are evenly distributed into all its accounts. Suppose the length of link is $N$, i.e. there are $N$ controlled accounts, and for every account, $\beta = \frac{\beta_0}{N}$. The in-and-out degree analysis is same with \refsec{sec:cheat-single}, the upper-bound of $\gamma$ is $K \cdot \beta$, where $K=2\cdot N$ is a constant integer. Therefore the upper-bound of the sum of all accounts owned by the attacker is:

\begin{align}
\mathcal{C} = N \cdot \frac{K \frac{\beta_0 ^2}{N}}{ (1+e^{a + b \cdot \frac{\beta_0}{N} }) (1+e^{c + K \cdot d \cdot \beta_0})} = \frac{K \beta_0 ^2 }{ (1+e^{a + b \cdot \frac{\beta_0}{N} }) (1+e^{c + K \cdot d \cdot \beta_0})} 
\end{align}


\subsection{Coalition Manipulation \label{sec:coalition}}
The result of coalition manipulation is no different with the case that one attacker owns the original total asset of two attackers. So here we can analyze the case of coalition manipulation by analyzing the consequence of a single attacker's assets increasing.



